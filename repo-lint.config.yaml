mode: strict

ignore:
  - node_modules
  - dist
  - .git
  - "*.d.ts"
  - bun.lock

layout:
  type: dir
  children:
    src:
      type: dir
      children:
        presets:
          type: dir
          optional: true
          children:
            "$preset":
              type: many
              case: kebab
              child:
                type: file
                pattern: "*.ts"
        types:
          type: dir
          optional: true
          children:
            "$type-defs":
              type: many
              pattern: "*.d.ts"
        index.ts: {}
        cli.ts: {}
        types.ts: {}
        case.ts: {}
        matcher.ts: {}
        scanner.ts: {}
        config.ts: {}
        checker.ts: {}
        output.ts: {}
        errors.ts: {}
    test:
      type: dir
      children:
        "$tests":
          type: many
          case: kebab
          child:
            type: file
            pattern: "*.test.ts"
        presets:
          type: dir
          optional: true
          children:
            "$preset-tests":
              type: many
              case: kebab
              child:
                type: file
                pattern: "*.test.ts"
    .husky:
      type: dir
      optional: true
      children:
        "$hooks":
          type: many
          optional: true
    .github:
      type: dir
      optional: true
      children:
        workflows:
          type: dir
          optional: true
          children:
            "$workflow":
              type: many
              pattern: "*.yml"
    package.json: {}
    tsconfig.json: {}
    repo-lint.config.yaml: {}
    .repo-lint.yaml:
      optional: true
    README.md:
      optional: true
    LICENSE:
      optional: true
    PLAN.md:
      optional: true
    CLAUDE.md:
      optional: true
    CONTRIBUTING.md:
      optional: true
    ".gitignore":
      optional: true
    "oxlint.json":
      optional: true
    "bunfig.toml":
      optional: true
    "commitlint.config.js":
      optional: true
    "knip.json":
      optional: true

rules:
  forbidNames:
    - temp
    - tmp
    - new
    - untitled

  forbidPaths:
    - "**/backup/**"
    - "**/.backup/**"

  mirror:
    - source: "src/*.ts"
      target: "test/*.test.ts"
      pattern: "*.ts -> *.test.ts"

  when:
    "src/case.ts":
      requires: ["test/case.test.ts"]
    "src/matcher.ts":
      requires: ["test/matcher.test.ts"]
    "src/checker.ts":
      requires: ["test/checker.test.ts"]
    "src/scanner.ts":
      requires: ["test/scanner.test.ts"]
    "src/config.ts":
      requires: ["test/config.test.ts"]
    "src/output.ts":
      requires: ["test/output.test.ts"]
